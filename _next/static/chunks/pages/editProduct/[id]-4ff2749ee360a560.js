(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[447],{9967:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/editProduct/[id]",function(){return n(6683)}])},1392:function(e,a,n){"use strict";var r=n(5893),t=n(7294),s=n(1163);a.Z=()=>{let[e,a]=(0,t.useState)(null),n=(0,s.useRouter)();return((0,t.useEffect)(()=>{let checkAuth=async()=>{try{let e=await fetch("https://www.aiwaelectronics.com.ar/checkAuth.php",{credentials:"include"}),r=await e.json();console.log("Auth Check Response:",r),r.authenticated?a(!0):(a(!1),n.push("/login"))}catch(e){console.error("Auth Error:",e),a(!1),n.push("/login")}};checkAuth()},[n]),null===e)?(0,r.jsx)("div",{children:"Loading..."}):e}},6683:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return _id_}});var r=n(5893),t=n(9008),s=n.n(t),l=n(5121),c=n(7294),i=n(1676),d=n(5005),o=n(1163);n(5079);var EditProducts_EditProducts=e=>{let{productId:a,category:n}=e,[t,s]=(0,c.useState)(!1),u=(0,o.useRouter)(),[h,p]=(0,c.useState)(),[m,g]=(0,c.useState)({id:"",sku:"",name:"",longDesc:"",shortDesc:"",img_url:[],colors:[],buyLink:"",driveLink:"",includes:[],features:[],featuredFeatures:[],categories:"",secondCategories:"",thirdCategories:"",line:"",published:!0,banners:[]}),[x,f]=(0,c.useState)([]),[j,v]=(0,c.useState)([]),[C,b]=(0,c.useState)([]);(0,c.useEffect)(()=>{let fetchProduct=async()=>{if(a&&n)try{let e=await l.Z.get("https://www.aiwaelectronics.com.ar/".concat(n,".php?id=").concat(a)),r=e.data,t=JSON.parse(r.banners),s=JSON.parse(r.img_url),c="string"==typeof r.includes?JSON.parse(r.includes):r.includes,i="string"==typeof r.featuredFeatures?JSON.parse(r.featuredFeatures):r.featuredFeatures,d=i.map(e=>e.id),o="string"==typeof r.features?JSON.parse(r.features):r.features,u=o.map(e=>({id:e.id||"",name:e.name||"",value:e.value||""}));g(e=>({...r,banners:t,img_url:s,includes:c,featuredFeatures:d,features:u,published:!0===r.published}))}catch(e){console.error("Error fetching product:",e)}},fetchIncludes=async()=>{try{let e=await l.Z.get("https://www.aiwaelectronics.com.ar/includes.php");f(e.data)}catch(e){console.error("Error fetching includes:",e)}},fetchFeaturedFeatures=async()=>{try{let e=await l.Z.get("https://www.aiwaelectronics.com.ar/featuredFeatures.php");v(e.data)}catch(e){console.error("Error fetching featured features:",e)}},fetchFeatures=async()=>{try{let e=await l.Z.get("https://www.aiwaelectronics.com.ar/features.php");b(e.data)}catch(e){console.error("Error fetching features:",e)}};fetchProduct(),fetchIncludes(),fetchFeaturedFeatures(),fetchFeatures()},[a,n]),(0,c.useEffect)(()=>{p(!m.published)},[m.published]);let handleChange=(e,a)=>{let{name:n,value:r,checked:t,type:s}=e.target,l=[...m.img_url],c="checkbox"===s?t:r;l[a]=c,g({...m,[n]:c,img_url:l})},handleChangeBanner=(e,a,n)=>{let r=[...m.banners];r[a]={...r[a],[n]:e.target.value},g({...m,banners:r})},handleRemoveBanner=e=>{let a=[...m.banners];a.splice(e,1),g({...m,banners:a})},handleIncludeChange=(e,a)=>{let n=[...m.includes];n[a]=e.target.value,g({...m,includes:n})},handleRemoveInclude=e=>{let a=[...m.includes];a.splice(e,1),g({...m,includes:a})},handleFeaturedFeatureChange=(e,a)=>{let n=[...m.featuredFeatures];n[a]=Number(e.target.value),g({...m,featuredFeatures:n})},handleRemoveFeaturedFeature=e=>{let a=[...m.featuredFeatures];a.splice(e,1),g({...m,featuredFeatures:a})},handleFeatureChange=(e,a,n)=>{let r=[...m.features],t={...r[a]};if("id"===n){let a=C.find(a=>a.id===e.target.value);t.id=e.target.value,t.name=a?a.name:""}else t[n]=e.target.value;r[a]=t,g({...m,features:r})},handleRemoveFeature=e=>{let a=[...m.features];a.splice(e,1),g({...m,features:a})},handleSubmit=async e=>{e.preventDefault();try{let e={...m,published:m.published?1:0,featuredFeatures:m.featuredFeatures.map(e=>({id:Number(e)})),features:m.features.map(e=>({id:e.id,name:e.name,value:e.value}))};await l.Z.put("https://www.aiwaelectronics.com.ar/".concat(n,".php?id=").concat(a),e),console.log("Product updated successfully"),s(!0)}catch(e){console.error("Error updating product:",e)}};return(0,r.jsx)("div",{className:"mt-4 p-5 bg-primary text-white rounded center",children:(0,r.jsx)("div",{className:"app-container",children:(0,r.jsxs)("div",{className:"app-contentEdit",children:[(0,r.jsxs)("div",{className:"app-content-header",children:[(0,r.jsx)("h1",{className:"app-content-headerText",children:"Editar producto"}),(0,r.jsx)("button",{onClick:()=>{u.push("/adminPanel")},variant:"danger",className:"app-content-headerButton",children:"Volver"})]}),(0,r.jsxs)("div",{className:"app-content-actions",children:[h&&(0,r.jsx)("div",{style:{color:"red",marginBottom:"10px"},children:"El producto no est\xe1 publicado. Seleccione 'Publicado' para que sea publicado."}),(0,r.jsxs)(i.Z.Group,{controlId:"published",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Check,{type:"checkbox",name:"published",checked:m.published,onChange:handleChange}),(0,r.jsx)(i.Z.Label,{children:"Publicado"})]}),(0,r.jsxs)(i.Z,{children:[(0,r.jsxs)(i.Z.Group,{controlId:"name",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Label,{children:"Nombre:"}),(0,r.jsx)(i.Z.Control,{type:"text",name:"name",value:m.name,onChange:handleChange})]}),(0,r.jsxs)(i.Z.Group,{controlId:"longDesc",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Label,{children:"Descripci\xf3n Larga:"}),(0,r.jsx)("textarea",{value:m.longDesc,name:"longDesc",onChange:handleChange})]}),(0,r.jsxs)(i.Z.Group,{controlId:"shortDesc",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Label,{children:"Descripci\xf3n Corta:"}),(0,r.jsx)("textarea",{value:m.shortDesc,name:"shortDesc",onChange:handleChange})]}),(0,r.jsxs)(i.Z.Group,{controlId:"sku",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Label,{children:"SKU:"}),(0,r.jsx)(i.Z.Control,{type:"text",name:"sku",value:m.sku,onChange:handleChange})]}),(0,r.jsxs)(i.Z.Group,{controlId:"buyLink",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Label,{children:"Link de Compra:"}),(0,r.jsx)(i.Z.Control,{type:"text",name:"buyLink",value:m.buyLink,onChange:handleChange})]}),(0,r.jsxs)(i.Z.Group,{controlId:"driveLink",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Label,{children:"Link de Descarga:"}),(0,r.jsx)(i.Z.Control,{type:"text",name:"driveLink",value:m.driveLink,onChange:handleChange})]}),(0,r.jsxs)(i.Z.Group,{controlId:"imgUrls",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Label,{children:"URLs de Im\xe1genes:"}),m.img_url.map((e,a)=>(0,r.jsx)("div",{style:{marginBottom:"10px"},className:"banner-entry",children:(0,r.jsx)(i.Z.Control,{type:"text",value:e,onChange:e=>handleChange(e,a),style:{width:"100%",height:"35px"}})},a)),(0,r.jsx)(d.Z,{variant:"danger",className:"app-content-headerButton",onClick:()=>{let e=[...m.img_url];e.push(""),g({...m,img_url:e})},children:"Agregar URL de imagen"})]}),(0,r.jsxs)(i.Z.Group,{controlId:"banners",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Label,{children:"Banners:"}),Array.isArray(m.banners)&&m.banners.map((e,a)=>(0,r.jsxs)("div",{className:"bannerForm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(i.Z.Control,{as:"textarea",style:{width:"15%",height:"auto",minHeight:"35px"},name:"banner_title_".concat(a),placeholder:"T\xedtulo",value:e.title,onChange:e=>handleChangeBanner(e,a,"title")}),(0,r.jsx)(i.Z.Control,{as:"textarea",style:{width:"40%",height:"auto",minHeight:"35px"},name:"banner_img_".concat(a),placeholder:"URL de la imagen",value:e.img,onChange:e=>handleChangeBanner(e,a,"img")}),(0,r.jsx)(i.Z.Control,{as:"textarea",style:{width:"45%",height:"auto",minHeight:"35px"},name:"banner_desc_".concat(a),placeholder:"Descripci\xf3n",value:e.desc,onChange:e=>handleChangeBanner(e,a,"desc")})]}),(0,r.jsx)("div",{children:(0,r.jsx)(d.Z,{variant:"danger",className:"app-content-headerButton",onClick:()=>handleRemoveBanner(a),children:"Eliminar"})})]},a)),(0,r.jsx)(d.Z,{variant:"danger",className:"app-content-headerButton",onClick:()=>{g({...m,banners:[...m.banners,{title:"",img:"",desc:""}]})},children:"Agregar Banner"})]}),(0,r.jsxs)(i.Z.Group,{controlId:"line",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Label,{children:"Linea:"}),(0,r.jsx)(i.Z.Control,{type:"text",name:"line",value:m.line,onChange:handleChange})]}),(0,r.jsxs)(i.Z.Group,{controlId:"includes",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Label,{children:"Incluye:"}),Array.isArray(m.includes)&&m.includes.length>0?m.includes.map((e,a)=>(0,r.jsxs)("div",{className:"include-entry",children:[(0,r.jsxs)("select",{value:e,onChange:e=>handleIncludeChange(e,a),children:[(0,r.jsx)("option",{value:"",children:"Selecciona un \xedtem"}),x.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.id," - ",e.name]},e.id))]}),(0,r.jsx)(d.Z,{onClick:()=>handleRemoveInclude(a),children:"Eliminar"})]},a)):(0,r.jsx)("p",{children:"No hay \xedtems incluidos."}),(0,r.jsx)(d.Z,{onClick:()=>{g({...m,includes:[...m.includes,""]})},children:"Agregar \xcdtem"})]}),(0,r.jsxs)(i.Z.Group,{controlId:"features",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Label,{children:"Caracter\xedsticas:"}),Array.isArray(m.features)&&m.features.map((e,a)=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("select",{value:e.id,onChange:e=>handleFeatureChange(e,a,"id"),children:[(0,r.jsx)("option",{value:"",children:"Selecciona una caracter\xedstica"}),C.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.id," - ",e.name]},e.id))]}),(0,r.jsx)(i.Z.Control,{type:"text",value:e.value,onChange:e=>handleFeatureChange(e,a,"value"),placeholder:"Valor"}),(0,r.jsx)(d.Z,{variant:"danger",onClick:()=>handleRemoveFeature(a),children:"Eliminar"})]},a)),(0,r.jsx)(d.Z,{onClick:()=>{g({...m,features:[...m.features,{id:"",name:"",value:""}]})},children:"Agregar Caracter\xedstica"})]}),(0,r.jsxs)(i.Z.Group,{controlId:"featuredFeatures",className:"nice-form-group",children:[(0,r.jsx)(i.Z.Label,{children:"Caracter\xedsticas Destacadas:"}),m.featuredFeatures.map((e,a)=>(0,r.jsxs)("div",{className:"featuredFeature-entry",children:[(0,r.jsx)("select",{name:"id",value:e,onChange:e=>handleFeaturedFeatureChange(e,a),children:j.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.id," - ",e.name]},e.id))}),(0,r.jsx)(d.Z,{variant:"danger",onClick:()=>handleRemoveFeaturedFeature(a),children:"Eliminar"})]},a)),(0,r.jsx)(d.Z,{variant:"secondary",onClick:()=>{g({...m,featuredFeatures:[...m.featuredFeatures,""]})},children:"A\xf1adir Caracter\xedstica"})]}),(0,r.jsx)("button",{onClick:handleSubmit,variant:"danger",className:"app-content-headerButton",style:{marginTop:"20px"},children:"Guardar Cambios"})]}),t&&(0,r.jsx)("div",{className:"alert alert-success",role:"alert",style:{marginTop:"20px",color:"white"},children:"Los cambios fueron guardados con \xe9xito."})]})]})})})},u=n(1392),_id_=()=>{let e=(0,u.Z)(),a=(0,o.useRouter)(),{id:n,category:t}=a.query;return null===e?(0,r.jsx)("div",{children:"Loading..."}):e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s(),{children:(0,r.jsx)("title",{children:"Editar producto"})}),n&&t&&(0,r.jsx)(EditProducts_EditProducts,{productId:n,category:t})]}):null}}},function(e){e.O(0,[121,495,774,888,179],function(){return e(e.s=9967)}),_N_E=e.O()}]);